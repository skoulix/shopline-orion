{{#comment}} Slideshow Section {{/comment}}
<div class="slideshow-section relative overflow-hidden">
  {{#if section.blocks.size > 0}}
    <div class="relative h-64 md:h-96 lg:h-screen max-h-[600px]">
      <!-- Slides -->
      {{#each section.blocks}}
        <div 
          class="slide absolute inset-0 transition-opacity duration-500 {{#unless @first}}opacity-0{{/unless}}"
          data-slide-index="{{@index}}"
        >
          {{#if settings.image}}
            <img 
              src="{{image settings.image width=1920 height=800}}" 
              alt="{{settings.title | default: 'Slide image'}}"
              class="w-full h-full object-cover"
            >
          {{else}}
            <div class="w-full h-full bg-gray-300"></div>
          {{/if}}
          
          <!-- Overlay -->
          {{#if settings.overlay_opacity}}
            <div 
              class="absolute inset-0 bg-black"
              style="opacity: {{divide settings.overlay_opacity 100}}"
            ></div>
          {{/if}}
          
          <!-- Content -->
          {{#if (or settings.title settings.subtitle settings.button_label)}}
            <div class="absolute inset-0 flex items-center justify-center">
              <div class="text-center px-4 max-w-4xl mx-auto">
                {{#if settings.title}}
                  <h2 class="text-4xl md:text-6xl font-bold text-white mb-4 drop-shadow-lg">
                    {{settings.title}}
                  </h2>
                {{/if}}
                
                {{#if settings.subtitle}}
                  <p class="text-lg md:text-xl text-white mb-8 drop-shadow-lg max-w-2xl mx-auto">
                    {{settings.subtitle}}
                  </p>
                {{/if}}
                
                {{#if settings.button_label}}
                  <a 
                    href="{{settings.button_link | default: '#'}}"
                    class="inline-block bg-red-600 text-white px-8 py-3 rounded-md font-medium hover:bg-red-700 transition-colors shadow-lg"
                  >
                    {{settings.button_label}}
                  </a>
                {{/if}}
              </div>
            </div>
          {{/if}}
        </div>
      {{/each}}
      
      {{#if section.blocks.size > 1}}
        <!-- Navigation Arrows -->
        <button 
          class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-3 rounded-full hover:bg-opacity-75 transition-all z-10"
          onclick="changeSlide(-1)"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
        </button>
        
        <button 
          class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-3 rounded-full hover:bg-opacity-75 transition-all z-10"
          onclick="changeSlide(1)"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
        
        <!-- Dots Indicator -->
        <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
          {{#each section.blocks}}
            <button 
              class="w-3 h-3 rounded-full transition-all {{#if @first}}bg-white{{else}}bg-white bg-opacity-50{{/if}}"
              onclick="goToSlide({{@index}})"
              data-dot-index="{{@index}}"
            ></button>
          {{/each}}
        </div>
      {{/if}}
    </div>
  {{else}}
    <!-- Empty State -->
    <div class="h-64 md:h-96 bg-gray-200 flex items-center justify-center">
      <div class="text-center">
        <h3 class="text-xl font-semibold text-gray-600 mb-2">Add slides to your slideshow</h3>
        <p class="text-gray-500">Configure your slideshow in the theme editor</p>
      </div>
    </div>
  {{/if}}
</div>

<script>
  let currentSlide = 0;
  const slides = document.querySelectorAll('.slide');
  const dots = document.querySelectorAll('[data-dot-index]');
  const totalSlides = slides.length;
  
  let autoplayInterval;
  
  function showSlide(index) {
    // Hide all slides
    slides.forEach(slide => slide.classList.add('opacity-0'));
    dots.forEach(dot => dot.classList.remove('bg-white'));
    dots.forEach(dot => dot.classList.add('bg-white', 'bg-opacity-50'));
    
    // Show current slide
    slides[index].classList.remove('opacity-0');
    if (dots[index]) {
      dots[index].classList.remove('bg-opacity-50');
      dots[index].classList.add('bg-white');
    }
    
    currentSlide = index;
  }
  
  function changeSlide(direction) {
    let newIndex = currentSlide + direction;
    
    if (newIndex >= totalSlides) {
      newIndex = 0;
    } else if (newIndex < 0) {
      newIndex = totalSlides - 1;
    }
    
    showSlide(newIndex);
  }
  
  function goToSlide(index) {
    showSlide(index);
  }
  
  // Auto-play functionality
  function startAutoplay() {
    {{#if section.settings.autoplay}}
      autoplayInterval = setInterval(() => {
        changeSlide(1);
      }, {{section.settings.autoplay_speed | default: 5000}});
    {{/if}}
  }
  
  function stopAutoplay() {
    if (autoplayInterval) {
      clearInterval(autoplayInterval);
    }
  }
  
  // Initialize
  document.addEventListener('DOMContentLoaded', () => {
    if (totalSlides > 1) {
      startAutoplay();
      
      // Pause autoplay on hover
      const slideshow = document.querySelector('.slideshow-section');
      slideshow.addEventListener('mouseenter', stopAutoplay);
      slideshow.addEventListener('mouseleave', startAutoplay);
    }
  });
</script>

{{#schema}}
{
  "name": "Slideshow",
  "class": "section",
  "max_blocks": 10,
  "settings": [
    {
      "type": "group_header",
      "label": "Slideshow settings"
    },
    {
      "type": "switch",
      "id": "autoplay",
      "label": "Auto-rotate slides",
      "default": true
    },
    {
      "type": "range",
      "id": "autoplay_speed",
      "label": "Auto-rotate speed",
      "min": 3000,
      "max": 10000,
      "step": 1000,
      "unit": "ms",
      "default": 5000
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "image",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Heading"
        },
        {
          "type": "textarea",
          "id": "subtitle",
          "label": "Subheading"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "label": "Overlay opacity",
          "min": 0,
          "max": 80,
          "step": 10,
          "unit": "%",
          "default": 30
        }
      ]
    }
  ]
}
{{/schema}}