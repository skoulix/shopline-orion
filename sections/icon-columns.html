<div class="icon-columns overflow-hidden" style="background-color: {{default section.settings.background_color '#ffffff'}};">
  <div class="{{#unless section.settings.full_width}}container{{/unless}} mx-auto" style="padding-top: {{default section.settings.padding_top 60}}px; padding-bottom: {{default section.settings.padding_bottom 60}}px;">
    
    {{#if section.settings.heading}}
      <div class="text-center mb-12">
        <h2 class="text-3xl sm:text-4xl md:text-4xl uppercase mb-4 font-heading" 
            style="font-family: {{#if (eq section.settings.heading_font 'title')}}var(--title-font){{else}}var(--body-font){{/if}}; color: {{default section.settings.heading_color '#000000'}};">
          {{section.settings.heading}}
        </h2>
        {{#if section.settings.subheading}}
          <p class="text-lg lg:text-xl" 
             style="color: {{default section.settings.subheading_color '#666666'}};">
            {{section.settings.subheading}}
          </p>
        {{/if}}
      </div>
    {{/if}}
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-6">
      {{#each section.blocks}}
        <div class="text-center">
          {{#if settings.icon}}
            <div class="mx-auto mb-6" style="max-width: {{default ../section.settings.icon_size 100}}px;">
              <div class="aspect-square">
                {{image_tag 
                  (image_url settings.icon width=300)
                  class='w-full h-full object-contain'
                  widths='100, 150, 200, 300'
                  loading='lazy'
                  sizes='(max-width: 768px) 100px, (max-width: 1024px) 80px, 100px'
                  alt=settings.icon.alt
                }}
              </div>
            </div>
          {{/if}}
          
          {{#if settings.title}}
            <h3 class="text-base lg:text-lg uppercase" 
                style="font-family: {{#if (eq ../section.settings.title_font 'title')}}var(--title-font){{else}}var(--body-font){{/if}}; color: {{default ../section.settings.title_color '#000000'}};">
              {{settings.title}}
            </h3>
          {{/if}}
          
          {{#if settings.description}}
            <p class="text-sm mt-3" 
               style="color: {{default ../section.settings.description_color '#666666'}};">
              {{settings.description}}
            </p>
          {{/if}}
        </div>
      {{/each}}
    </div>
    
    {{#if section.settings.button_label}}
      <div class="text-center mt-12">
        {{#if section.settings.button_link}}
          {{assign "parsed_link" (JSONparse section.settings.button_link)}}
          {{#if parsed_link.pageType}}
            {{#if (eq parsed_link.pageType 3)}}
              <a href="/pages/{{parsed_link.value}}" class="button inline-block transition-all duration-200" style="background-color: {{default section.settings.button_bg_color '#e3276f'}}; color: {{default section.settings.button_text_color '#ffffff'}}; border-radius: var(--button-radius, 6px); {{#if section.settings.button_border_enabled}}border: {{default section.settings.button_border_width 2}}px solid {{default section.settings.button_border_color '#ffffff'}};{{/if}}">
                {{section.settings.button_label}}
              </a>
            {{else}}
              {{#if (eq parsed_link.pageType 12)}}
                <a href="/collections/{{parsed_link.value}}" class="button inline-block transition-all duration-200" style="background-color: {{default section.settings.button_bg_color '#e3276f'}}; color: {{default section.settings.button_text_color '#ffffff'}}; border-radius: var(--button-radius, 6px); {{#if section.settings.button_border_enabled}}border: {{default section.settings.button_border_width 2}}px solid {{default section.settings.button_border_color '#ffffff'}};{{/if}}">
                  {{section.settings.button_label}}
                </a>
              {{else}}
                {{#if (eq parsed_link.pageType 10)}}
                  <a href="/products/{{parsed_link.value}}" class="button inline-block transition-all duration-200" style="background-color: {{default section.settings.button_bg_color '#e3276f'}}; color: {{default section.settings.button_text_color '#ffffff'}}; border-radius: var(--button-radius, 6px); {{#if section.settings.button_border_enabled}}border: {{default section.settings.button_border_width 2}}px solid {{default section.settings.button_border_color '#ffffff'}};{{/if}}">
                    {{section.settings.button_label}}
                  </a>
                {{else}}
                  <a href="{{parsed_link.value}}" class="button inline-block transition-all duration-200" style="background-color: {{default section.settings.button_bg_color '#e3276f'}}; color: {{default section.settings.button_text_color '#ffffff'}}; border-radius: var(--button-radius, 6px); {{#if section.settings.button_border_enabled}}border: {{default section.settings.button_border_width 2}}px solid {{default section.settings.button_border_color '#ffffff'}};{{/if}}">
                    {{section.settings.button_label}}
                  </a>
                {{/if}}
              {{/if}}
            {{/if}}
          {{else}}
            <a href="{{default section.settings.button_link '#'}}" class="button inline-block transition-all duration-200" style="background-color: {{default section.settings.button_bg_color '#e3276f'}}; color: {{default section.settings.button_text_color '#ffffff'}}; border-radius: var(--button-radius, 6px); {{#if section.settings.button_border_enabled}}border: {{default section.settings.button_border_width 2}}px solid {{default section.settings.button_border_color '#ffffff'}};{{/if}}">
              {{section.settings.button_label}}
            </a>
          {{/if}}
        {{else}}
          <a href="#" class="button inline-block transition-all duration-200" style="background-color: {{default section.settings.button_bg_color '#e3276f'}}; color: {{default section.settings.button_text_color '#ffffff'}}; border-radius: var(--button-radius, 6px); {{#if section.settings.button_border_enabled}}border: {{default section.settings.button_border_width 2}}px solid {{default section.settings.button_border_color '#ffffff'}};{{/if}}">
            {{section.settings.button_label}}
          </a>
        {{/if}}
      </div>
    {{/if}}
    
  </div>
</div>

{{#schema}}
{
  "name": "Icon Columns",
  "class": "section-icon-columns",
  "settings": [
    {
      "type": "group_header",
      "label": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section heading"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Section subheading"
    },
    {
      "type": "group_header",
      "label": "Typography"
    },
    {
      "type": "select",
      "id": "heading_font",
      "label": "Heading font",
      "default": "title",
      "options": [
        {
          "value": "title",
          "label": "Title font"
        },
        {
          "value": "body",
          "label": "Body font"
        }
      ]
    },
    {
      "type": "select",
      "id": "title_font",
      "label": "Column title font",
      "default": "title",
      "options": [
        {
          "value": "title",
          "label": "Title font"
        },
        {
          "value": "body",
          "label": "Body font"
        }
      ]
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Subheading color",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Column title color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "description_color",
      "label": "Description color",
      "default": "#666666"
    },
    {
      "type": "group_header",
      "label": "Icons"
    },
    {
      "type": "range",
      "id": "icon_size",
      "label": "Icon size",
      "default": 100,
      "min": 60,
      "max": 200,
      "step": 10,
      "unit": "px"
    },
    {
      "type": "group_header",
      "label": "Button"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Button background color",
      "default": "#e3276f"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#ffffff"
    },
    {
      "type": "switch",
      "id": "button_border_enabled",
      "label": "Enable button border",
      "default": false
    },
    {
      "type": "color",
      "id": "button_border_color",
      "label": "Button border color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "button_border_width",
      "label": "Button border width",
      "default": 2,
      "min": 1,
      "max": 5,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "group_header",
      "label": "Layout"
    },
    {
      "type": "switch",
      "id": "full_width",
      "label": "Full width",
      "default": false
    },
    {
      "type": "group_header",
      "label": "Appearance"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "group_header",
      "label": "Section spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Top padding",
      "default": 60,
      "max": 200,
      "min": 0,
      "step": 4,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Bottom padding",
      "default": 60,
      "max": 200,
      "min": 0,
      "step": 4,
      "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "column",
      "name": "Icon Column",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Feature Title"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Icon Columns",
      "blocks": [
        {
          "type": "column",
          "settings": {
            "title": "NATURAL & ENDURING ENERGY",
            "description": "Experience sustained energy without the crash"
          }
        },
        {
          "type": "column",
          "settings": {
            "title": "SUPPORTS MENTAL FOCUS & CLARITY",
            "description": "Enhanced cognitive function and mental clarity"
          }
        },
        {
          "type": "column",
          "settings": {
            "title": "SUPPORTS GUT & METABOLIC HEALTH",
            "description": "Promotes digestive wellness and metabolic function"
          }
        },
        {
          "type": "column",
          "settings": {
            "title": "FULL TRANSPARENCY",
            "description": "Complete ingredient transparency and quality assurance"
          }
        }
      ]
    }
  ]
}
{{/schema}}